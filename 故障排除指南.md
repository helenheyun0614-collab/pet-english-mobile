# 🔧 故障排除指南

## 问题：导入后关闭重开没有数据

### 📋 快速诊断步骤

#### 步骤1：运行测试页面
```
1. 双击打开：测试本地存储.html
2. 点击所有测试按钮
3. 查看测试结果
```

**如果第1个测试失败**：localStorage不可用，见"解决方案A"
**如果第4个测试没有数据**：保存失败，见"解决方案B"

---

## 解决方案A：localStorage不可用

### 原因1：使用了隐私/无痕模式
**症状**：每次关闭都丢失数据
**解决**：
- Chrome: 关闭无痕窗口，使用普通窗口
- Safari: 关闭私人浏览模式
- Firefox: 退出隐私窗口

### 原因2：浏览器设置禁用了localStorage
**Chrome设置**：
```
1. 打开设置 → 隐私和安全
2. Cookie和其他网站数据
3. 确保选择"允许所有Cookie"或添加例外
```

**Safari设置**：
```
1. 偏好设置 → 隐私
2. 取消勾选"阻止所有Cookie"
```

**Firefox设置**：
```
1. 设置 → 隐私与安全
2. Cookie和网站数据
3. 确保未勾选"删除Cookie和网站数据"
```

### 原因3：浏览器版本太旧
**解决**：更新浏览器到最新版本
- Chrome: 设置 → 关于Chrome
- Safari: Mac系统更新
- Edge: 设置 → 关于Microsoft Edge

---

## 解决方案B：数据保存失败

### 检查1：确认导入成功
```
1. 打开 src/index.html
2. 按 F12 打开开发者工具
3. 切换到 Console 标签
4. 导入Excel文件
5. 查看是否有"✅ 数据已保存到localStorage"
```

**如果没有这条消息**：导入有错误

### 检查2：查看localStorage
```
1. 按 F12 打开开发者工具
2. 切换到 Application 标签（Chrome）或 Storage 标签（Firefox）
3. 左侧选择 Local Storage → file://
4. 查看是否有 petEnglishData 项
```

**如果没有这个项**：保存失败

### 检查3：查看错误信息
```
在 Console 标签中查看是否有红色错误信息
常见错误：
- QuotaExceededError: 存储空间不足
- SecurityError: 安全策略阻止
- 其他JavaScript错误
```

---

## 解决方案C：浏览器兼容性

### 推荐浏览器（按优先级）

1. **Chrome**（强烈推荐）✅
   - 最佳兼容性
   - 完整支持localStorage
   - 开发工具最好用

2. **Microsoft Edge**（推荐）✅
   - 基于Chromium
   - 兼容性好

3. **Firefox**（推荐）✅
   - 兼容性良好
   - 可能需要调整设置

4. **Safari**（可用）⚠️
   - Mac/iOS默认浏览器
   - 可能有额外限制
   - 确保设置正确

### 不推荐
- ❌ IE浏览器（不支持）
- ❌ 旧版本浏览器

---

## 解决方案D：文件路径问题

### 确保文件结构正确
```
Pet/
├── src/
│   ├── index.html  ← 打开这个
│   └── pet-content.js
├── libs/
│   └── xlsx.full.min.js
└── 测试本地存储.html
```

### 打开方式
**正确** ✅：
- 双击 src/index.html
- 或在浏览器中：文件 → 打开文件

**错误** ❌：
- 不要通过其他应用打开
- 不要在网盘中直接打开

---

## 解决方案E：清除并重试

### 步骤
```
1. 打开 测试本地存储.html
2. 点击"清除所有数据"
3. 关闭所有浏览器窗口
4. 重新打开 src/index.html
5. 重新导入Excel文件
6. 测试是否保存成功
```

---

## 详细测试步骤

### 完整测试流程

#### 1. 准备测试Excel文件
使用最简单的格式：
```
创建一个Excel文件，命名为 test.xlsx
第一行：word | meaning | example
第二行：test | 测试 | This is a test.
保存为 .xlsx 格式
```

#### 2. 测试导入
```
1. 打开 src/index.html
2. 按 F12 打开开发者工具
3. 点击"📁 导入题库"
4. 选择"单词背诵"
5. 上传 test.xlsx
6. 点击"确认导入"
```

#### 3. 验证保存
在Console标签中应该看到：
```
✅ 数据已保存到localStorage
```

#### 4. 验证数据
```
1. 切换到 Application 标签
2. Local Storage → file://
3. 点击 petEnglishData
4. 应该看到JSON数据
```

#### 5. 测试恢复
```
1. 关闭浏览器标签（或整个浏览器）
2. 重新打开 src/index.html
3. 查看底部统计，单词数量应该是 1
4. 点击"单词背诵"，应该能看到 test 这个单词
```

---

## 常见问题FAQ

### Q1: Console在哪里？
**A**: 按F12（Windows）或 Cmd+Option+I（Mac）

### Q2: Application标签找不到？
**A**: 
- Chrome: 就叫 Application
- Firefox: 叫 Storage
- Safari: 开发 → 显示Web检查器 → 存储

### Q3: 显示"✅ 已加载保存的数据"但没有题目？
**A**: 
1. 检查 petEnglishData 的内容是否为空
2. 确认导入的Excel格式正确
3. 尝试清除数据重新导入

### Q4: 一直提示保存成功，但重开还是没有？
**A**: 
1. 确认不是无痕模式
2. 检查浏览器设置是否"退出时清除数据"
3. 尝试其他浏览器

### Q5: 手机上能用吗？
**A**: 
可以，但：
- 需要在手机浏览器中打开
- 某些移动浏览器可能有限制
- 推荐使用Chrome或Safari

---

## 终极解决方案

如果以上方法都不行：

### 方法1：使用本地服务器
```bash
# 安装Python（如果没有）
# 然后在Pet文件夹运行：
python3 -m http.server 8000

# 在浏览器访问：
http://localhost:8000/src/index.html
```

使用http://方式打开，localStorage更稳定。

### 方法2：使用在线版本
将整个文件夹上传到：
- GitHub Pages
- Netlify
- Vercel

### 方法3：联系支持
如果还是不行，提供以下信息：
1. 浏览器名称和版本
2. 操作系统
3. 测试页面的截图
4. Console中的错误信息

---

## 验证成功的标志

✅ **确认本地存储正常工作**：

1. 导入Excel后看到："💾 数据已保存到本地"
2. Console显示："✅ 数据已保存到localStorage"
3. Application标签能看到 petEnglishData
4. 关闭重开后底部统计数字不变
5. 能看到之前导入的题目

**如果以上5点都满足，说明功能正常！** 🎉

---

## 预防措施

### 避免数据丢失

1. **保存Excel源文件**
   - 导入的Excel文件要保存好
   - 可以随时重新导入

2. **不要清除浏览器数据**
   - 清理缓存时注意不要清除网站数据
   - 或先导出备份

3. **使用推荐浏览器**
   - Chrome或Edge最稳定
   - 更新到最新版本

4. **定期检查**
   - 偶尔打开测试页面检查数据
   - 确保一切正常

---

**需要更多帮助？** 

1. 运行 `测试本地存储.html` 诊断问题
2. 查看 `使用说明.txt` 快速参考
3. 检查浏览器控制台的错误信息

**祝早日解决问题！** 💪




















