<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>æ•°æ®éªŒè¯</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #1e1e1e; color: #fff; }
        .result { margin: 10px 0; padding: 10px; background: #2d2d2d; border-radius: 4px; }
        .success { color: #4caf50; }
        .error { color: #f44336; }
        button { padding: 10px 20px; margin: 5px; background: #2196f3; color: white; border: none; cursor: pointer; }
        button:hover { background: #1976d2; }
    </style>
</head>
<body>
    <h1>PETæ•°æ®éªŒè¯å·¥å…·</h1>
    <div id="output"></div>
    <button onclick="testData()">æµ‹è¯•æ•°æ®ç”Ÿæˆ</button>
    <button onclick="restoreData()">æ¢å¤æ•°æ®åˆ°localStorage</button>
    <button onclick="openApp()">æ‰“å¼€åº”ç”¨</button>

    <script>
        const output = document.getElementById('output');

        function log(msg, type = '') {
            const div = document.createElement('div');
            div.className = 'result ' + type;
            div.textContent = msg;
            output.appendChild(div);
            console.log(msg);
        }

        async function testData() {
            output.innerHTML = '';
            log('=== å¼€å§‹æµ‹è¯• ===');

            try {
                // åŠ¨æ€åŠ è½½ pet-content.js
                const script = document.createElement('script');
                script.src = 'src/pet-content.js';
                script.onload = () => {
                    if (!window.petContent) {
                        log('âŒ window.petContent æœªå®šä¹‰', 'error');
                        return;
                    }

                    const stats = {
                        å•è¯: window.petContent.vocab?.length || 0,
                        é˜…è¯»: window.petContent.readingSets?.length || 0,
                        æ­é…: window.petContent.collocationSets?.length || 0,
                        å®Œå½¢: window.petContent.clozeSets?.length || 0
                    };

                    log(`ğŸ“Š æ•°æ®ç»Ÿè®¡:`, 'success');
                    log(`  å•è¯: ${stats.å•è¯}`);
                    log(`  é˜…è¯»: ${stats.é˜…è¯»}`);
                    log(`  æ­é…: ${stats.æ­é…}`);
                    log(`  å®Œå½¢: ${stats.å®Œå½¢}`);

                    // æ£€æŸ¥æ¯ä¸ªæ¨¡å—çš„å‰å‡ æ¡æ•°æ®
                    if (stats.é˜…è¯» > 0) {
                        log(`\nğŸ” é˜…è¯»ç†è§£ç¬¬1é¢˜:`, 'success');
                        log(`  ID: ${window.petContent.readingSets[0].id}`);
                        log(`  é—®é¢˜: ${window.petContent.readingSets[0].question?.substring(0, 50)}...`);

                        if (stats.é˜…è¯» > 1) {
                            log(`\nğŸ” é˜…è¯»ç†è§£ç¬¬2é¢˜:`, 'success');
                            log(`  ID: ${window.petContent.readingSets[1].id}`);
                            log(`  é—®é¢˜: ${window.petContent.readingSets[1].question?.substring(0, 50)}...`);
                        }

                        if (stats.é˜…è¯» > 100) {
                            log(`\nğŸ” é˜…è¯»ç†è§£ç¬¬100é¢˜:`, 'success');
                            log(`  ID: ${window.petContent.readingSets[99].id}`);
                        }

                        if (stats.é˜…è¯» > 150) {
                            log(`\nğŸ” é˜…è¯»ç†è§£ç¬¬150é¢˜:`, 'success');
                            log(`  ID: ${window.petContent.readingSets[149].id}`);
                        }
                    }

                    if (stats.é˜…è¯» === 200) {
                        log(`\nâœ… æ•°æ®å®Œæ•´ï¼`, 'success');
                    } else {
                        log(`\nâš ï¸ é¢„æœŸ200é“é˜…è¯»é¢˜ï¼Œå®é™…${stats.é˜…è¯»}é“`, 'error');
                    }
                };
                script.onerror = () => {
                    log('âŒ pet-content.js åŠ è½½å¤±è´¥', 'error');
                };
                document.head.appendChild(script);
            } catch (e) {
                log(`âŒ é”™è¯¯: ${e.message}`, 'error');
            }
        }

        function restoreData() {
            if (!window.petContent) {
                log('âŒ è¯·å…ˆç‚¹å‡»"æµ‹è¯•æ•°æ®ç”Ÿæˆ"', 'error');
                return;
            }

            const data = {
                vocab: window.petContent.vocab,
                readingSets: window.petContent.readingSets,
                collocationSets: window.petContent.collocationSets,
                clozeSets: window.petContent.clozeSets
            };

            localStorage.setItem('petEnglishData', JSON.stringify(data));
            localStorage.setItem('petEnglishData_backup', JSON.stringify(data));

            const total = (data.vocab?.length || 0) +
                         (data.readingSets?.length || 0) +
                         (data.collocationSets?.length || 0) +
                         (data.clozeSets?.length || 0);

            log(`âœ… å·²æ¢å¤ ${total} æ¡æ•°æ®åˆ° localStorage`, 'success');
        }

        function openApp() {
            window.location.href = 'src/index.html';
        }

        // è‡ªåŠ¨è¿è¡Œæµ‹è¯•
        window.onload = () => testData();
    </script>
</body>
</html>
