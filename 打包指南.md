# 📦 打包桌面应用完整指南

## 第一步：安装依赖

### 方法1：使用默认npm源（如果网络允许）

```bash
npm install
```

### 方法2：使用国内镜像源（推荐，速度更快）

```bash
# 设置淘宝镜像
npm config set registry https://registry.npmmirror.com

# 安装依赖
npm install
```

### 方法3：使用cnpm（如果已安装）

```bash
cnpm install
```

## 第二步：测试运行

在打包之前，先测试应用是否能正常运行：

```bash
npm run dev
```

如果看到应用窗口正常打开，说明配置正确。

## 第三步：打包应用

### macOS 打包

```bash
npm run build:mac
```

打包完成后，在 `dist` 目录会生成：
- `PET魔法英语屋-1.0.0.dmg` - 可直接分发的安装包

### Windows 打包

```bash
npm run build:win
```

打包完成后，在 `dist` 目录会生成：
- `PET魔法英语屋 Setup 1.0.0.exe` - Windows安装程序

### Linux 打包

```bash
npm run build:linux
```

打包完成后，在 `dist` 目录会生成：
- `PET魔法英语屋-1.0.0.AppImage` - Linux可执行文件

### 打包当前平台

```bash
npm run build
```

会自动检测当前操作系统并打包对应版本。

## 常见问题解决

### 问题1：npm install 失败

**解决方案：**
1. 检查网络连接
2. 使用国内镜像：`npm config set registry https://registry.npmmirror.com`
3. 清除缓存：`npm cache clean --force`
4. 删除 `node_modules` 和 `package-lock.json`，重新安装

### 问题2：electron-builder 找不到

**解决方案：**
```bash
# 全局安装 electron-builder
npm install -g electron-builder

# 或者使用 npx
npx electron-builder
```

### 问题3：打包速度慢

**原因：** 首次打包需要下载 Electron 二进制文件（约100MB）

**解决方案：**
- 使用国内镜像：`export ELECTRON_MIRROR="https://npmmirror.com/mirrors/electron/"`
- 耐心等待，后续打包会快很多

### 问题4：macOS 打包后无法运行

**解决方案：**
1. 系统设置 → 安全性与隐私 → 允许"未知开发者"
2. 或者在终端运行：`xattr -cr "dist/PET魔法英语屋.app"`

### 问题5：文件路径错误

**检查：**
- 确保 `libs/xlsx.full.min.js` 文件存在
- 确保 `src/index.html` 中的路径正确：`../libs/xlsx.full.min.js`

## 打包后的文件结构

```
dist/
├── PET魔法英语屋-1.0.0.dmg          (macOS)
├── PET魔法英语屋 Setup 1.0.0.exe    (Windows)
└── PET魔法英语屋-1.0.0.AppImage    (Linux)
```

## 分发应用

打包完成后，可以将 `dist` 目录中的安装包分发给用户：

- **macOS**: 分享 `.dmg` 文件，用户双击安装
- **Windows**: 分享 `.exe` 文件，用户运行安装程序
- **Linux**: 分享 `.AppImage` 文件，用户添加执行权限后运行

## 优化建议

1. **添加应用图标**：在 `assets/` 目录放置图标文件
   - macOS: `icon.icns`
   - Windows: `icon.ico`
   - Linux: `icon.png`

2. **代码签名**（可选）：用于正式分发
   - macOS: 需要 Apple Developer 账号
   - Windows: 需要代码签名证书

3. **自动更新**（可选）：可以配置自动更新功能

## 技术支持

如果遇到问题，请检查：
1. Node.js 版本（建议 16+）
2. 网络连接
3. 磁盘空间（打包需要约500MB空间）
4. 查看错误日志

---

**祝打包顺利！** 🎉



















